<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mushroom Midterm</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="mushroom_midterm_quarto_files/libs/clipboard/clipboard.min.js"></script>
<script src="mushroom_midterm_quarto_files/libs/quarto-html/quarto.js"></script>
<script src="mushroom_midterm_quarto_files/libs/quarto-html/popper.min.js"></script>
<script src="mushroom_midterm_quarto_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="mushroom_midterm_quarto_files/libs/quarto-html/anchor.min.js"></script>
<link href="mushroom_midterm_quarto_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="mushroom_midterm_quarto_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="mushroom_midterm_quarto_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="mushroom_midterm_quarto_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="mushroom_midterm_quarto_files/libs/bootstrap/bootstrap-464ca616a42634851f8c2e5e7a9e5523.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mushroom Midterm</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="predicting-the-edibility-of-mushrooms" class="level3">
<h3 class="anchored" data-anchor-id="predicting-the-edibility-of-mushrooms">Predicting the edibility of mushrooms</h3>
</section>
<section id="philip-fowler" class="level3">
<h3 class="anchored" data-anchor-id="philip-fowler">Philip Fowler</h3>
</section>
<section id="date-started-2025-03-17" class="level3">
<h3 class="anchored" data-anchor-id="date-started-2025-03-17">date started: 2025-03-17</h3>
</section>
<section id="section-1-load-and-explore-the-data" class="level1">
<h1>Section 1 Load and Explore the Data</h1>
<section id="load-the-data" class="level2">
<h2 class="anchored" data-anchor-id="load-the-data">1.1 Load the Data</h2>
<div id="cell-3" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ucimlrepo <span class="im">import</span> fetch_ucirepo</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression, Lasso</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder, StandardScaler</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> chi2, SelectKBest, RFE</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> recall_score, precision_score, f1_score, classification_report, confusion_matrix, accuracy_score</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier, plot_tree</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>dont_panic <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">"whitegrid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fetch dataset </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mushroom <span class="op">=</span> fetch_ucirepo(<span class="bu">id</span><span class="op">=</span><span class="dv">73</span>) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># data (as pandas dataframes) </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> mushroom.data.features </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> mushroom.data.targets </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># metadata </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mushroom.metadata) </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># I love that UCI includes this metadata.  It is in the readme as it is easier to access there.</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'uci_id': 73, 'name': 'Mushroom', 'repository_url': 'https://archive.ics.uci.edu/dataset/73/mushroom', 'data_url': 'https://archive.ics.uci.edu/static/public/73/data.csv', 'abstract': 'From Audobon Society Field Guide; mushrooms described in terms of physical characteristics; classification: poisonous or edible', 'area': 'Biology', 'tasks': ['Classification'], 'characteristics': ['Multivariate'], 'num_instances': 8124, 'num_features': 22, 'feature_types': ['Categorical'], 'demographics': [], 'target_col': ['poisonous'], 'index_col': None, 'has_missing_values': 'yes', 'missing_values_symbol': 'NaN', 'year_of_dataset_creation': 1981, 'last_updated': 'Thu Aug 10 2023', 'dataset_doi': '10.24432/C5959T', 'creators': [], 'intro_paper': None, 'additional_info': {'summary': "This data set includes descriptions of hypothetical samples corresponding to 23 species of gilled mushrooms in the Agaricus and Lepiota Family (pp. 500-525).  Each species is identified as definitely edible, definitely poisonous, or of unknown edibility and not recommended.  This latter class was combined with the poisonous one.  The Guide clearly states that there is no simple rule for determining the edibility of a mushroom; no rule like ``leaflets three, let it be'' for Poisonous Oak and Ivy.", 'purpose': None, 'funded_by': None, 'instances_represent': None, 'recommended_data_splits': None, 'sensitive_data': None, 'preprocessing_description': None, 'variable_info': '     1. cap-shape:                bell=b,conical=c,convex=x,flat=f, knobbed=k,sunken=s\r\n     2. cap-surface:              fibrous=f,grooves=g,scaly=y,smooth=s\r\n     3. cap-color:                brown=n,buff=b,cinnamon=c,gray=g,green=r, pink=p,purple=u,red=e,white=w,yellow=y\r\n     4. bruises?:                 bruises=t,no=f\r\n     5. odor:                     almond=a,anise=l,creosote=c,fishy=y,foul=f, musty=m,none=n,pungent=p,spicy=s\r\n     6. gill-attachment:          attached=a,descending=d,free=f,notched=n\r\n     7. gill-spacing:             close=c,crowded=w,distant=d\r\n     8. gill-size:                broad=b,narrow=n\r\n     9. gill-color:               black=k,brown=n,buff=b,chocolate=h,gray=g, green=r,orange=o,pink=p,purple=u,red=e, white=w,yellow=y\r\n    10. stalk-shape:              enlarging=e,tapering=t\r\n    11. stalk-root:               bulbous=b,club=c,cup=u,equal=e, rhizomorphs=z,rooted=r,missing=?\r\n    12. stalk-surface-above-ring: fibrous=f,scaly=y,silky=k,smooth=s\r\n    13. stalk-surface-below-ring: fibrous=f,scaly=y,silky=k,smooth=s\r\n    14. stalk-color-above-ring:   brown=n,buff=b,cinnamon=c,gray=g,orange=o, pink=p,red=e,white=w,yellow=y\r\n    15. stalk-color-below-ring:   brown=n,buff=b,cinnamon=c,gray=g,orange=o, pink=p,red=e,white=w,yellow=y\r\n    16. veil-type:                partial=p,universal=u\r\n    17. veil-color:               brown=n,orange=o,white=w,yellow=y\r\n    18. ring-number:              none=n,one=o,two=t\r\n    19. ring-type:                cobwebby=c,evanescent=e,flaring=f,large=l, none=n,pendant=p,sheathing=s,zone=z\r\n    20. spore-print-color:        black=k,brown=n,buff=b,chocolate=h,green=r, orange=o,purple=u,white=w,yellow=y\r\n    21. population:               abundant=a,clustered=c,numerous=n, scattered=s,several=v,solitary=y\r\n    22. habitat:                  grasses=g,leaves=l,meadows=m,paths=p, urban=u,waste=w,woods=d', 'citation': None}}</code></pre>
</div>
</div>
</section>
<section id="check-for-missing-and-display-summary-statistics" class="level2">
<h2 class="anchored" data-anchor-id="check-for-missing-and-display-summary-statistics">1.2 Check for missing and display summary statistics</h2>
<div id="cell-6" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variable information </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mushroom.variables) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        name     role         type demographic  \
0                  poisonous   Target  Categorical        None   
1                  cap-shape  Feature  Categorical        None   
2                cap-surface  Feature  Categorical        None   
3                  cap-color  Feature       Binary        None   
4                    bruises  Feature  Categorical        None   
5                       odor  Feature  Categorical        None   
6            gill-attachment  Feature  Categorical        None   
7               gill-spacing  Feature  Categorical        None   
8                  gill-size  Feature  Categorical        None   
9                 gill-color  Feature  Categorical        None   
10               stalk-shape  Feature  Categorical        None   
11                stalk-root  Feature  Categorical        None   
12  stalk-surface-above-ring  Feature  Categorical        None   
13  stalk-surface-below-ring  Feature  Categorical        None   
14    stalk-color-above-ring  Feature  Categorical        None   
15    stalk-color-below-ring  Feature  Categorical        None   
16                 veil-type  Feature       Binary        None   
17                veil-color  Feature  Categorical        None   
18               ring-number  Feature  Categorical        None   
19                 ring-type  Feature  Categorical        None   
20         spore-print-color  Feature  Categorical        None   
21                population  Feature  Categorical        None   
22                   habitat  Feature  Categorical        None   

                                          description units missing_values  
0                                                None  None             no  
1   bell=b,conical=c,convex=x,flat=f, knobbed=k,su...  None             no  
2                fibrous=f,grooves=g,scaly=y,smooth=s  None             no  
3   brown=n,buff=b,cinnamon=c,gray=g,green=r, pink...  None             no  
4                                      bruises=t,no=f  None             no  
5   almond=a,anise=l,creosote=c,fishy=y,foul=f, mu...  None             no  
6            attached=a,descending=d,free=f,notched=n  None             no  
7                         close=c,crowded=w,distant=d  None             no  
8                                    broad=b,narrow=n  None             no  
9   black=k,brown=n,buff=b,chocolate=h,gray=g, gre...  None             no  
10                             enlarging=e,tapering=t  None             no  
11  bulbous=b,club=c,cup=u,equal=e, rhizomorphs=z,...  None            yes  
12                 fibrous=f,scaly=y,silky=k,smooth=s  None             no  
13                 fibrous=f,scaly=y,silky=k,smooth=s  None             no  
14  brown=n,buff=b,cinnamon=c,gray=g,orange=o, pin...  None             no  
15  brown=n,buff=b,cinnamon=c,gray=g,orange=o, pin...  None             no  
16                              partial=p,universal=u  None             no  
17                  brown=n,orange=o,white=w,yellow=y  None             no  
18                                 none=n,one=o,two=t  None             no  
19  cobwebby=c,evanescent=e,flaring=f,large=l, non...  None             no  
20  black=k,brown=n,buff=b,chocolate=h,green=r, or...  None             no  
21  abundant=a,clustered=c,numerous=n, scattered=s...  None             no  
22  grasses=g,leaves=l,meadows=m,paths=p, urban=u,...  None             no  </code></pre>
</div>
</div>
<div id="cell-7" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The features we will use in our model.  </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>x.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">cap-shape</th>
<th data-quarto-table-cell-role="th">cap-surface</th>
<th data-quarto-table-cell-role="th">cap-color</th>
<th data-quarto-table-cell-role="th">bruises</th>
<th data-quarto-table-cell-role="th">odor</th>
<th data-quarto-table-cell-role="th">gill-attachment</th>
<th data-quarto-table-cell-role="th">gill-spacing</th>
<th data-quarto-table-cell-role="th">gill-size</th>
<th data-quarto-table-cell-role="th">gill-color</th>
<th data-quarto-table-cell-role="th">stalk-shape</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">stalk-surface-below-ring</th>
<th data-quarto-table-cell-role="th">stalk-color-above-ring</th>
<th data-quarto-table-cell-role="th">stalk-color-below-ring</th>
<th data-quarto-table-cell-role="th">veil-type</th>
<th data-quarto-table-cell-role="th">veil-color</th>
<th data-quarto-table-cell-role="th">ring-number</th>
<th data-quarto-table-cell-role="th">ring-type</th>
<th data-quarto-table-cell-role="th">spore-print-color</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">habitat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>x</td>
<td>s</td>
<td>n</td>
<td>t</td>
<td>p</td>
<td>f</td>
<td>c</td>
<td>n</td>
<td>k</td>
<td>e</td>
<td>...</td>
<td>s</td>
<td>w</td>
<td>w</td>
<td>p</td>
<td>w</td>
<td>o</td>
<td>p</td>
<td>k</td>
<td>s</td>
<td>u</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>x</td>
<td>s</td>
<td>y</td>
<td>t</td>
<td>a</td>
<td>f</td>
<td>c</td>
<td>b</td>
<td>k</td>
<td>e</td>
<td>...</td>
<td>s</td>
<td>w</td>
<td>w</td>
<td>p</td>
<td>w</td>
<td>o</td>
<td>p</td>
<td>n</td>
<td>n</td>
<td>g</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>b</td>
<td>s</td>
<td>w</td>
<td>t</td>
<td>l</td>
<td>f</td>
<td>c</td>
<td>b</td>
<td>n</td>
<td>e</td>
<td>...</td>
<td>s</td>
<td>w</td>
<td>w</td>
<td>p</td>
<td>w</td>
<td>o</td>
<td>p</td>
<td>n</td>
<td>n</td>
<td>m</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>x</td>
<td>y</td>
<td>w</td>
<td>t</td>
<td>p</td>
<td>f</td>
<td>c</td>
<td>n</td>
<td>n</td>
<td>e</td>
<td>...</td>
<td>s</td>
<td>w</td>
<td>w</td>
<td>p</td>
<td>w</td>
<td>o</td>
<td>p</td>
<td>k</td>
<td>s</td>
<td>u</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>x</td>
<td>s</td>
<td>g</td>
<td>f</td>
<td>n</td>
<td>f</td>
<td>w</td>
<td>b</td>
<td>k</td>
<td>t</td>
<td>...</td>
<td>s</td>
<td>w</td>
<td>w</td>
<td>p</td>
<td>w</td>
<td>o</td>
<td>e</td>
<td>n</td>
<td>a</td>
<td>g</td>
</tr>
</tbody>
</table>

<p>5 rows × 22 columns</p>
</div>
</div>
</div>
<div id="cell-8" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our target variable.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">poisonous</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>p</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>e</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>e</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>p</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>e</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many rows and columns?</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>x.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>(8124, 22)</code></pre>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>y.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>(8124, 1)</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's get some descriptive statistics.</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>x.describe().T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">unique</th>
<th data-quarto-table-cell-role="th">top</th>
<th data-quarto-table-cell-role="th">freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">cap-shape</td>
<td>8124</td>
<td>6</td>
<td>x</td>
<td>3656</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">cap-surface</td>
<td>8124</td>
<td>4</td>
<td>y</td>
<td>3244</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">cap-color</td>
<td>8124</td>
<td>10</td>
<td>n</td>
<td>2284</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bruises</td>
<td>8124</td>
<td>2</td>
<td>f</td>
<td>4748</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">odor</td>
<td>8124</td>
<td>9</td>
<td>n</td>
<td>3528</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">gill-attachment</td>
<td>8124</td>
<td>2</td>
<td>f</td>
<td>7914</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">gill-spacing</td>
<td>8124</td>
<td>2</td>
<td>c</td>
<td>6812</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">gill-size</td>
<td>8124</td>
<td>2</td>
<td>b</td>
<td>5612</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">gill-color</td>
<td>8124</td>
<td>12</td>
<td>b</td>
<td>1728</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">stalk-shape</td>
<td>8124</td>
<td>2</td>
<td>t</td>
<td>4608</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">stalk-root</td>
<td>5644</td>
<td>4</td>
<td>b</td>
<td>3776</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">stalk-surface-above-ring</td>
<td>8124</td>
<td>4</td>
<td>s</td>
<td>5176</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">stalk-surface-below-ring</td>
<td>8124</td>
<td>4</td>
<td>s</td>
<td>4936</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">stalk-color-above-ring</td>
<td>8124</td>
<td>9</td>
<td>w</td>
<td>4464</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">stalk-color-below-ring</td>
<td>8124</td>
<td>9</td>
<td>w</td>
<td>4384</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">veil-type</td>
<td>8124</td>
<td>1</td>
<td>p</td>
<td>8124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">veil-color</td>
<td>8124</td>
<td>4</td>
<td>w</td>
<td>7924</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ring-number</td>
<td>8124</td>
<td>3</td>
<td>o</td>
<td>7488</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ring-type</td>
<td>8124</td>
<td>5</td>
<td>p</td>
<td>3968</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">spore-print-color</td>
<td>8124</td>
<td>9</td>
<td>w</td>
<td>2388</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">population</td>
<td>8124</td>
<td>6</td>
<td>v</td>
<td>4040</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">habitat</td>
<td>8124</td>
<td>7</td>
<td>d</td>
<td>3148</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>y.describe().T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">unique</th>
<th data-quarto-table-cell-role="th">top</th>
<th data-quarto-table-cell-role="th">freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">poisonous</td>
<td>8124</td>
<td>2</td>
<td>e</td>
<td>4208</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-13" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do we have nulls?</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>x.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>cap-shape                      0
cap-surface                    0
cap-color                      0
bruises                        0
odor                           0
gill-attachment                0
gill-spacing                   0
gill-size                      0
gill-color                     0
stalk-shape                    0
stalk-root                  2480
stalk-surface-above-ring       0
stalk-surface-below-ring       0
stalk-color-above-ring         0
stalk-color-below-ring         0
veil-type                      0
veil-color                     0
ring-number                    0
ring-type                      0
spore-print-color              0
population                     0
habitat                        0
dtype: int64</code></pre>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequency of unique values for stalk-root</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>stalk_root_counts <span class="op">=</span> x[<span class="st">'stalk-root'</span>].value_counts()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stalk_root_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>stalk-root
b    3776
e    1120
c     556
r     192
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
</section>
<section id="section-2-visualize-the-data" class="level1">
<h1>Section 2 Visualize the Data</h1>
<section id="create-plots-to-visualize-the-data" class="level2">
<h2 class="anchored" data-anchor-id="create-plots-to-visualize-the-data">2.1 Create plots to visualize the data</h2>
<div id="cell-16" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the occurrences of each class in the target variable</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>class_counts <span class="op">=</span> y[<span class="st">'poisonous'</span>].value_counts()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the bar chart using seaborn</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">'poisonous'</span>, data<span class="op">=</span>y, palette<span class="op">=</span>[<span class="st">'red'</span>, <span class="st">'green'</span>])</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Counts of Poisonous and Edible Mushrooms'</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Class'</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Count'</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>], labels<span class="op">=</span>[<span class="st">'Edible'</span>, <span class="st">'Poisonous'</span>], rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>There are roughly equal numbers of edible and poisonous mushrooms in the dataset. The dataset is balanced.</p>
<div id="cell-18" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create countplots for each column in the x dataframe</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> x.columns:</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    sns.countplot(y<span class="op">=</span>column, data<span class="op">=</span>x, palette<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f'Countplot of </span><span class="sc">{</span>column<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-7.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-8.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-9.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-10.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-11.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-12.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-13.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-14.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-15.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-16.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-17.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-18.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-19.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-20.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-21.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-14-output-22.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>All of these values are categorical, so we will need to encode them before we can use them in a machine learning model. More specifically, all of these values are nominal, so we will need to use one-hot encoding. Ring number could be considered ordinal, but we will treat it as nominal for now.</p>
</section>
</section>
<section id="section-3-feature-selection-and-justification" class="level1">
<h1>Section 3 Feature Selection and Justification</h1>
<section id="select-features-and-justify-selection" class="level2">
<h2 class="anchored" data-anchor-id="select-features-and-justify-selection">3.1 Select features and justify selection</h2>
<div id="cell-21" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Make a copy of x and name it x_uncleaned</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>x_uncleaned <span class="op">=</span> x.copy()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Drop the column stalk-root and name it x_dropcolumn</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>x_dropcolumn <span class="op">=</span> x.drop(columns<span class="op">=</span>[<span class="st">'stalk-root'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The uncleaned dataset has not been modified in any way. The dropcolumn dataset has had the stalk-root column removed as there were numerous (~30%) missing values in this column.</p>
<div id="cell-23" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode categorical features as numbers</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>x_encoded <span class="op">=</span> x.<span class="bu">apply</span>(LabelEncoder().fit_transform)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-squared test</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>chi2_scores, p_values <span class="op">=</span> chi2(x_encoded, y.<span class="bu">apply</span>(LabelEncoder().fit_transform))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame to display the results</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>chi2_results <span class="op">=</span> pd.DataFrame({<span class="st">'Feature'</span>: x.columns, <span class="st">'Chi2 Score'</span>: chi2_scores, <span class="st">'p-value'</span>: p_values})</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(chi2_results.sort_values(by<span class="op">=</span><span class="st">'p-value'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Feature   Chi2 Score        p-value
7                  gill-size  1636.606833   0.000000e+00
8                 gill-color  5957.764469   0.000000e+00
18                 ring-type  1950.610146   0.000000e+00
3                    bruises  1194.277352  1.069037e-261
6               gill-spacing   826.795274  8.061293e-182
21                   habitat   751.309489  2.082916e-165
10                stalk-root   425.896927   1.270374e-94
19         spore-print-color   379.132729   1.922119e-84
20                population   311.766736   9.002366e-70
11  stalk-surface-above-ring   222.982400   2.022392e-50
1                cap-surface   214.068544   1.779362e-48
12  stalk-surface-below-ring   206.648180   7.398869e-47
13    stalk-color-above-ring   119.792216   7.024638e-28
14    stalk-color-below-ring   109.789410   1.089740e-25
4                       odor    75.910163   2.968682e-18
9                stalk-shape    36.594105   1.454709e-09
17               ring-number    25.646335   4.100735e-07
0                  cap-shape    17.508364   2.860465e-05
2                  cap-color    11.511382   6.917135e-04
16                veil-color     5.126826   2.355878e-02
5            gill-attachment     3.505447   6.116734e-02
15                 veil-type          NaN            NaN</code></pre>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the model</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LogisticRegression()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize RFE with the model and the number of features to select</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>rfe <span class="op">=</span> RFE(model, n_features_to_select<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit RFE</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>rfe <span class="op">=</span> rfe.fit(x_encoded, y.<span class="bu">apply</span>(LabelEncoder().fit_transform))</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the ranking of the features</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>ranking <span class="op">=</span> rfe.ranking_</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame to display the feature rankings</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>feature_ranking <span class="op">=</span> pd.DataFrame({<span class="st">'Feature'</span>: x.columns, <span class="st">'Ranking'</span>: ranking})</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the features and their rankings</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_ranking.sort_values(by<span class="op">=</span><span class="st">'Ranking'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Feature  Ranking
3                    bruises        1
7                  gill-size        1
6               gill-spacing        1
5            gill-attachment        1
10                stalk-root        1
11  stalk-surface-above-ring        1
9                stalk-shape        1
17               ring-number        1
18                 ring-type        1
20                population        1
16                veil-color        2
4                       odor        3
1                cap-surface        4
12  stalk-surface-below-ring        5
8                 gill-color        6
13    stalk-color-above-ring        7
14    stalk-color-below-ring        8
0                  cap-shape        9
19         spore-print-color       10
21                   habitat       11
2                  cap-color       12
15                 veil-type       13</code></pre>
</div>
</div>
<div id="cell-25" class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the top features selected by RFE</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>rfe_top10_features <span class="op">=</span> feature_ranking[feature_ranking[<span class="st">'Ranking'</span>] <span class="op">&lt;=</span> <span class="dv">6</span>][<span class="st">'Feature'</span>].tolist()</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the top features selected by chi-squared test</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>chi2_top10_features <span class="op">=</span> chi2_results.nsmallest(<span class="dv">14</span>, <span class="st">'p-value'</span>)[<span class="st">'Feature'</span>].tolist()</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the common features in both lists</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>common_top10_features <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(rfe_top10_features) <span class="op">&amp;</span> <span class="bu">set</span>(chi2_top10_features))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Top 10 features selected by both RFE and chi-squared test:"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(common_top10_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top 10 features selected by both RFE and chi-squared test:
['cap-surface', 'bruises', 'gill-color', 'gill-size', 'gill-spacing', 'population', 'stalk-root', 'stalk-surface-above-ring', 'ring-type', 'stalk-surface-below-ring']</code></pre>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Make a copy of x with only the top 10 features and name it x_top10</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>x_top10 <span class="op">=</span> x[common_top10_features]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>x_top10.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">cap-surface</th>
<th data-quarto-table-cell-role="th">bruises</th>
<th data-quarto-table-cell-role="th">gill-color</th>
<th data-quarto-table-cell-role="th">gill-size</th>
<th data-quarto-table-cell-role="th">gill-spacing</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">stalk-root</th>
<th data-quarto-table-cell-role="th">stalk-surface-above-ring</th>
<th data-quarto-table-cell-role="th">ring-type</th>
<th data-quarto-table-cell-role="th">stalk-surface-below-ring</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>s</td>
<td>t</td>
<td>k</td>
<td>n</td>
<td>c</td>
<td>s</td>
<td>e</td>
<td>s</td>
<td>p</td>
<td>s</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>s</td>
<td>t</td>
<td>k</td>
<td>b</td>
<td>c</td>
<td>n</td>
<td>c</td>
<td>s</td>
<td>p</td>
<td>s</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>s</td>
<td>t</td>
<td>n</td>
<td>b</td>
<td>c</td>
<td>n</td>
<td>c</td>
<td>s</td>
<td>p</td>
<td>s</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>y</td>
<td>t</td>
<td>n</td>
<td>n</td>
<td>c</td>
<td>s</td>
<td>e</td>
<td>s</td>
<td>p</td>
<td>s</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>s</td>
<td>f</td>
<td>k</td>
<td>b</td>
<td>w</td>
<td>a</td>
<td>e</td>
<td>s</td>
<td>e</td>
<td>s</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the top features selected by RFE</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>rfe_top5_features <span class="op">=</span> feature_ranking[feature_ranking[<span class="st">'Ranking'</span>] <span class="op">&lt;=</span> <span class="dv">1</span>][<span class="st">'Feature'</span>].tolist()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the top features selected by chi-squared test</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>chi2_top5_features <span class="op">=</span> chi2_results.nsmallest(<span class="dv">7</span>, <span class="st">'p-value'</span>)[<span class="st">'Feature'</span>].tolist()</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the common features in both lists</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>common_top5_features <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(rfe_top5_features) <span class="op">&amp;</span> <span class="bu">set</span>(chi2_top5_features))</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Top 5 features selected by both RFE and chi-squared test:"</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(common_top5_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top 5 features selected by both RFE and chi-squared test:
['bruises', 'gill-size', 'gill-spacing', 'stalk-root', 'ring-type']</code></pre>
</div>
</div>
<div id="cell-28" class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Make a copy of x with only the top 5 features and name it x_top5</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>x_top5 <span class="op">=</span> x[common_top5_features]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>x_top5.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="136">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">bruises</th>
<th data-quarto-table-cell-role="th">gill-size</th>
<th data-quarto-table-cell-role="th">gill-spacing</th>
<th data-quarto-table-cell-role="th">stalk-root</th>
<th data-quarto-table-cell-role="th">ring-type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>t</td>
<td>n</td>
<td>c</td>
<td>e</td>
<td>p</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>t</td>
<td>b</td>
<td>c</td>
<td>c</td>
<td>p</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>t</td>
<td>b</td>
<td>c</td>
<td>c</td>
<td>p</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>t</td>
<td>n</td>
<td>c</td>
<td>e</td>
<td>p</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>f</td>
<td>b</td>
<td>w</td>
<td>e</td>
<td>e</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One-hot encode the datasets</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>x_uncleaned_encoded <span class="op">=</span> pd.get_dummies(x_uncleaned)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>x_dropcolumn_encoded <span class="op">=</span> pd.get_dummies(x_dropcolumn)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>x_top10_encoded <span class="op">=</span> pd.get_dummies(x_top10)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>x_top5_encoded <span class="op">=</span> pd.get_dummies(x_top5)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows of each encoded dataset</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_uncleaned_encoded.head())</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_dropcolumn_encoded.head())</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_top10_encoded.head())</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_top5_encoded.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   cap-shape_b  cap-shape_c  cap-shape_f  cap-shape_k  cap-shape_s  \
0        False        False        False        False        False   
1        False        False        False        False        False   
2         True        False        False        False        False   
3        False        False        False        False        False   
4        False        False        False        False        False   

   cap-shape_x  cap-surface_f  cap-surface_g  cap-surface_s  cap-surface_y  \
0         True          False          False           True          False   
1         True          False          False           True          False   
2        False          False          False           True          False   
3         True          False          False          False           True   
4         True          False          False           True          False   

   ...  population_s  population_v  population_y  habitat_d  habitat_g  \
0  ...          True         False         False      False      False   
1  ...         False         False         False      False       True   
2  ...         False         False         False      False      False   
3  ...          True         False         False      False      False   
4  ...         False         False         False      False       True   

   habitat_l  habitat_m  habitat_p  habitat_u  habitat_w  
0      False      False      False       True      False  
1      False      False      False      False      False  
2      False       True      False      False      False  
3      False      False      False       True      False  
4      False      False      False      False      False  

[5 rows x 116 columns]
   cap-shape_b  cap-shape_c  cap-shape_f  cap-shape_k  cap-shape_s  \
0        False        False        False        False        False   
1        False        False        False        False        False   
2         True        False        False        False        False   
3        False        False        False        False        False   
4        False        False        False        False        False   

   cap-shape_x  cap-surface_f  cap-surface_g  cap-surface_s  cap-surface_y  \
0         True          False          False           True          False   
1         True          False          False           True          False   
2        False          False          False           True          False   
3         True          False          False          False           True   
4         True          False          False           True          False   

   ...  population_s  population_v  population_y  habitat_d  habitat_g  \
0  ...          True         False         False      False      False   
1  ...         False         False         False      False       True   
2  ...         False         False         False      False      False   
3  ...          True         False         False      False      False   
4  ...         False         False         False      False       True   

   habitat_l  habitat_m  habitat_p  habitat_u  habitat_w  
0      False      False      False       True      False  
1      False      False      False      False      False  
2      False       True      False      False      False  
3      False      False      False       True      False  
4      False      False      False      False      False  

[5 rows x 112 columns]
   cap-surface_f  cap-surface_g  cap-surface_s  cap-surface_y  bruises_f  \
0          False          False           True          False      False   
1          False          False           True          False      False   
2          False          False           True          False      False   
3          False          False          False           True      False   
4          False          False           True          False       True   

   bruises_t  gill-color_b  gill-color_e  gill-color_g  gill-color_h  ...  \
0       True         False         False         False         False  ...   
1       True         False         False         False         False  ...   
2       True         False         False         False         False  ...   
3       True         False         False         False         False  ...   
4      False         False         False         False         False  ...   

   stalk-surface-above-ring_y  ring-type_e  ring-type_f  ring-type_l  \
0                       False        False        False        False   
1                       False        False        False        False   
2                       False        False        False        False   
3                       False        False        False        False   
4                       False         True        False        False   

   ring-type_n  ring-type_p  stalk-surface-below-ring_f  \
0        False         True                       False   
1        False         True                       False   
2        False         True                       False   
3        False         True                       False   
4        False        False                       False   

   stalk-surface-below-ring_k  stalk-surface-below-ring_s  \
0                       False                        True   
1                       False                        True   
2                       False                        True   
3                       False                        True   
4                       False                        True   

   stalk-surface-below-ring_y  
0                       False  
1                       False  
2                       False  
3                       False  
4                       False  

[5 rows x 45 columns]
   bruises_f  bruises_t  gill-size_b  gill-size_n  gill-spacing_c  \
0      False       True        False         True            True   
1      False       True         True        False            True   
2      False       True         True        False            True   
3      False       True        False         True            True   
4       True      False         True        False           False   

   gill-spacing_w  stalk-root_b  stalk-root_c  stalk-root_e  stalk-root_r  \
0           False         False         False          True         False   
1           False         False          True         False         False   
2           False         False          True         False         False   
3           False         False         False          True         False   
4            True         False         False          True         False   

   ring-type_e  ring-type_f  ring-type_l  ring-type_n  ring-type_p  
0        False        False        False        False         True  
1        False        False        False        False         True  
2        False        False        False        False         True  
3        False        False        False        False         True  
4         True        False        False        False        False  </code></pre>
</div>
</div>
<p>notes: one hot encoding was used over label encoding to avoid any ordinal assumptions. FRom what I am able to glean from the data, none of the featers are ordinal.</p>
</section>
</section>
<section id="section-4-train-and-evaluate-models" class="level1">
<h1>Section 4 Train and Evaluate Models</h1>
<section id="train-models" class="level2">
<h2 class="anchored" data-anchor-id="train-models">4.1 Train Models</h2>
<div id="cell-32" class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare one-hot encoded datasets</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>datasets_encoded <span class="op">=</span> {</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Uncleaned'</span>: x_uncleaned_encoded,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Drop Column'</span>: x_dropcolumn_encoded,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Top 10 Features'</span>: x_top10_encoded,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Top 5 Features'</span>: x_top5_encoded</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to train and evaluate models</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate_models(x_train, y_train, x_test, y_test):</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    models <span class="op">=</span> {</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Logistic Regression'</span>: LogisticRegression(class_weight<span class="op">=</span>{<span class="dv">0</span>: <span class="dv">1</span>, <span class="dv">1</span>: <span class="dv">2</span>}),</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Decision Tree'</span>: DecisionTreeClassifier(class_weight<span class="op">=</span>{<span class="dv">0</span>: <span class="dv">1</span>, <span class="dv">1</span>: <span class="dv">2</span>}, min_samples_leaf<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'SVM'</span>: SVC(kernel<span class="op">=</span><span class="st">'linear'</span>, class_weight<span class="op">=</span>{<span class="dv">0</span>: <span class="dv">1</span>, <span class="dv">1</span>: <span class="dv">2</span>}, C<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> {}</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> model_name, model <span class="kw">in</span> models.items():</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        model.fit(x_train, y_train)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> model.predict(x_test)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>        accuracy <span class="op">=</span> accuracy_score(y_test, predictions)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>        precision <span class="op">=</span> precision_score(y_test, predictions)</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>        recall <span class="op">=</span> recall_score(y_test, predictions)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>        f1 <span class="op">=</span> f1_score(y_test, predictions)</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>        confusion <span class="op">=</span> confusion_matrix(y_test, predictions)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>        results[model_name] <span class="op">=</span> {</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Accuracy'</span>: accuracy,</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Precision'</span>: precision,</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall'</span>: recall,</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">'F1 Score'</span>: f1,</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Confusion Matrix'</span>: confusion</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode target variable</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>y_encoded <span class="op">=</span> y.<span class="bu">apply</span>(LabelEncoder().fit_transform)</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Split datasets and evaluate models</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>all_results <span class="op">=</span> {}</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dataset_name, dataset <span class="kw">in</span> datasets_encoded.items():</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>    x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(dataset, y_encoded, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span>dont_panic)</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> evaluate_models(x_train, y_train, x_test, y_test)</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>    all_results[dataset_name] <span class="op">=</span> results</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dataset_name, results <span class="kw">in</span> all_results.items():</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Results for </span><span class="sc">{</span>dataset_name<span class="sc">}</span><span class="ss"> dataset:"</span>)</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> model_name, metrics <span class="kw">in</span> results.items():</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> metric_name, value <span class="kw">in</span> metrics.items():</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> metric_name <span class="op">==</span> <span class="st">'Confusion Matrix'</span>:</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"    </span><span class="sc">{</span>metric_name<span class="sc">}</span><span class="ss">:</span><span class="ch">\n</span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"    </span><span class="sc">{</span>metric_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Results for Uncleaned dataset:
  Logistic Regression:
    Accuracy: 1.0000
    Precision: 1.0000
    Recall: 1.0000
    F1 Score: 1.0000
    Confusion Matrix:
[[843   0]
 [  0 782]]
  Decision Tree:
    Accuracy: 1.0000
    Precision: 1.0000
    Recall: 1.0000
    F1 Score: 1.0000
    Confusion Matrix:
[[843   0]
 [  0 782]]
  SVM:
    Accuracy: 1.0000
    Precision: 1.0000
    Recall: 1.0000
    F1 Score: 1.0000
    Confusion Matrix:
[[843   0]
 [  0 782]]

Results for Drop Column dataset:
  Logistic Regression:
    Accuracy: 1.0000
    Precision: 1.0000
    Recall: 1.0000
    F1 Score: 1.0000
    Confusion Matrix:
[[843   0]
 [  0 782]]
  Decision Tree:
    Accuracy: 1.0000
    Precision: 1.0000
    Recall: 1.0000
    F1 Score: 1.0000
    Confusion Matrix:
[[843   0]
 [  0 782]]
  SVM:
    Accuracy: 1.0000
    Precision: 1.0000
    Recall: 1.0000
    F1 Score: 1.0000
    Confusion Matrix:
[[843   0]
 [  0 782]]

Results for Top 10 Features dataset:
  Logistic Regression:
    Accuracy: 0.9791
    Precision: 0.9629
    Recall: 0.9949
    F1 Score: 0.9786
    Confusion Matrix:
[[813  30]
 [  4 778]]
  Decision Tree:
    Accuracy: 0.9988
    Precision: 0.9974
    Recall: 1.0000
    F1 Score: 0.9987
    Confusion Matrix:
[[841   2]
 [  0 782]]
  SVM:
    Accuracy: 0.9785
    Precision: 0.9617
    Recall: 0.9949
    F1 Score: 0.9780
    Confusion Matrix:
[[812  31]
 [  4 778]]

Results for Top 5 Features dataset:
  Logistic Regression:
    Accuracy: 0.9145
    Precision: 0.9170
    Recall: 0.9041
    F1 Score: 0.9105
    Confusion Matrix:
[[779  64]
 [ 75 707]]
  Decision Tree:
    Accuracy: 0.9538
    Precision: 1.0000
    Recall: 0.9041
    F1 Score: 0.9496
    Confusion Matrix:
[[843   0]
 [ 75 707]]
  SVM:
    Accuracy: 0.9218
    Precision: 0.9315
    Recall: 0.9041
    F1 Score: 0.9176
    Confusion Matrix:
[[791  52]
 [ 75 707]]
</code></pre>
</div>
</div>
<div id="cell-33" class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the results dictionary to a DataFrame</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame.from_dict({(i, j): all_results[i][j] </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                           <span class="cf">for</span> i <span class="kw">in</span> all_results.keys() </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                           <span class="cf">for</span> j <span class="kw">in</span> all_results[i].keys()},</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                       orient<span class="op">=</span><span class="st">'index'</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the DataFrame</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                     Accuracy  Precision    Recall  F1 Score  \
Uncleaned       Logistic Regression  1.000000   1.000000  1.000000  1.000000   
                Decision Tree        1.000000   1.000000  1.000000  1.000000   
                SVM                  1.000000   1.000000  1.000000  1.000000   
Drop Column     Logistic Regression  1.000000   1.000000  1.000000  1.000000   
                Decision Tree        1.000000   1.000000  1.000000  1.000000   
                SVM                  1.000000   1.000000  1.000000  1.000000   
Top 10 Features Logistic Regression  0.979077   0.962871  0.994885  0.978616   
                Decision Tree        0.998769   0.997449  1.000000  0.998723   
                SVM                  0.978462   0.961681  0.994885  0.978001   
Top 5 Features  Logistic Regression  0.914462   0.916991  0.904092  0.910496   
                Decision Tree        0.953846   1.000000  0.904092  0.949631   
                SVM                  0.921846   0.931489  0.904092  0.917586   

                                           Confusion Matrix  
Uncleaned       Logistic Regression    [[843, 0], [0, 782]]  
                Decision Tree          [[843, 0], [0, 782]]  
                SVM                    [[843, 0], [0, 782]]  
Drop Column     Logistic Regression    [[843, 0], [0, 782]]  
                Decision Tree          [[843, 0], [0, 782]]  
                SVM                    [[843, 0], [0, 782]]  
Top 10 Features Logistic Regression   [[813, 30], [4, 778]]  
                Decision Tree          [[841, 2], [0, 782]]  
                SVM                   [[812, 31], [4, 778]]  
Top 5 Features  Logistic Regression  [[779, 64], [75, 707]]  
                Decision Tree         [[843, 0], [75, 707]]  
                SVM                  [[791, 52], [75, 707]]  </code></pre>
</div>
</div>
</section>
<section id="evaluate-models" class="level2">
<h2 class="anchored" data-anchor-id="evaluate-models">4.2 Evaluate Models</h2>
<div id="cell-35" class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new DataFrame with the desired columns, excluding 'Confusion Matrix'</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>table_df <span class="op">=</span> results_df.reset_index()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>table_df.columns <span class="op">=</span> [<span class="st">'Dataset'</span>, <span class="st">'Model'</span>, <span class="st">'Accuracy'</span>, <span class="st">'Precision'</span>, <span class="st">'Recall'</span>, <span class="st">'F1 Score'</span>, <span class="st">'Confusion Matrix'</span>]</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>table_df <span class="op">=</span> table_df.drop(columns<span class="op">=</span>[<span class="st">'Confusion Matrix'</span>])</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the metrics to percentages</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>table_df[[<span class="st">'Accuracy'</span>, <span class="st">'Precision'</span>, <span class="st">'Recall'</span>, <span class="st">'F1 Score'</span>]] <span class="op">=</span> table_df[[<span class="st">'Accuracy'</span>, <span class="st">'Precision'</span>, <span class="st">'Recall'</span>, <span class="st">'F1 Score'</span>]] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the metrics to two decimal places</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>table_df[[<span class="st">'Accuracy'</span>, <span class="st">'Precision'</span>, <span class="st">'Recall'</span>, <span class="st">'F1 Score'</span>]] <span class="op">=</span> table_df[[<span class="st">'Accuracy'</span>, <span class="st">'Precision'</span>, <span class="st">'Recall'</span>, <span class="st">'F1 Score'</span>]].<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the table</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>ax.axis(<span class="st">'tight'</span>)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>ax.axis(<span class="st">'off'</span>)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> ax.table(cellText<span class="op">=</span>table_df.values, colLabels<span class="op">=</span>table_df.columns, cellLoc<span class="op">=</span><span class="st">'center'</span>, loc<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the table to an image</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">'results_table.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-36" class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot confusion matrix</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_confusion_matrix(ax, conf_matrix, model_name, dataset_name):</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    sns.heatmap(conf_matrix, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'d'</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>, xticklabels<span class="op">=</span>[<span class="st">'Edible'</span>, <span class="st">'Poisonous'</span>], yticklabels<span class="op">=</span>[<span class="st">'Edible'</span>, <span class="st">'Poisonous'</span>], ax<span class="op">=</span>ax)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss"> on </span><span class="sc">{</span>dataset_name<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'Predicted'</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Actual'</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a figure with 4 rows and 3 columns of subplots</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">4</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot confusion matrices for each model and dataset</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dataset_name, results <span class="kw">in</span> all_results.items():</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> model_name, metrics <span class="kw">in</span> results.items():</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>        plot_confusion_matrix(axes[index], metrics[<span class="st">'Confusion Matrix'</span>], model_name, dataset_name)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>        index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust layout</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-37" class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to train and plot decision tree</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_decision_tree(x_train, y_train, dataset_name):</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the model</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    tree_model <span class="op">=</span> DecisionTreeClassifier()</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the model</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    tree_model.fit(x_train, y_train)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the tree</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    plot_tree(tree_model, filled<span class="op">=</span><span class="va">True</span>, feature_names<span class="op">=</span>x_train.columns, class_names<span class="op">=</span>[<span class="st">'Edible'</span>, <span class="st">'Poisonous'</span>], rounded<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f"Decision Tree for </span><span class="sc">{</span>dataset_name<span class="sc">}</span><span class="ss"> Dataset"</span>)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot decision tree for each dataset</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>plot_decision_tree(x_uncleaned_encoded, y_encoded, <span class="st">'Uncleaned'</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>plot_decision_tree(x_dropcolumn_encoded, y_encoded, <span class="st">'Drop Column'</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>plot_decision_tree(x_top10_encoded, y_encoded, <span class="st">'Top 10 Features'</span>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>plot_decision_tree(x_top5_encoded, y_encoded, <span class="st">'Top 5 Features'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-27-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-27-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="mushroom_midterm_quarto_files/figure-html/cell-27-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>